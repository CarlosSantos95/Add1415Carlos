<html>
<head>
		<meta http-equiv="content-type" content="text/html;charset=utf-8" />
	<title>Samba</title>
</head>
<body>
<div style='display:table-row; padding: 10px;'>
  <div style='float: left; width=20%; padding:10px;'>
  <img src='./files/logo.png'/>
  </div>
  <div style='float: left;padding:10px'>
  <ul>
    <li><b>M&oacute;dulo:</b> <i>Sistemas Operativos</i></li>
    <li><b>T&iacute;tulo del trabajo</b> <i>Samba</i></li>
    <li><b>Componentes del grupo:</b> <i>Carlos Santos Carballo</i></li>
    <li><b>Curso Acad&eacute;mico:</b> <i>2014/2015</i></li>
    <li><b>Fecha de entrega:</b> <i>13 de Marzo de 2015</i></li>
  </ul>
  </div>
</div>
<div style='float: clear;background-color: #eeeeee; border:2px solid; border-radius:10px; padding: 10px;'>
<a href='#bloque1'>Servidor</a> | <a href='#bloque2'>Cliente Windows</a> | <a href='#final'>Cliente Linux</a>
</div>
<h1><a id='bloque1'>Servidor</a></h1>
<p>Nuestro servidor será un Debian 7. En el configuraremos nuestra interfaz de red en el servidor.</p>
 <p align='center'><img  src='./files/1.png'/></p>
 <p>Modificamos el fichero "/etc/hostname" para cambiar el nombre de la máquina.</p>
  <p align='center'><img  src='./files/2.png'/></p>
  <p>A continuaciónintalamos ssh server.</p>
   <p align='center'><img  src='./files/3.png'/></p>
   <p align='center'>Una vez hecho esto, debemos crear los siguientes grupos y usuarios.</p>
   <p align='center'>Grupo informaticos con info1, info2 y supersamba.</p>
   <p align='center'>Grupo panaderos con pan1 y pan2 y supersamba.</p>
   <p align='center'>Crear el usuario smbguest.</p>
   <p align='center'><img  src='./files/4.png'/></p>
   <p align='center'><img  src='./files/5.png'/></p>
   <p align='center'><img  src='./files/6.png'/></p>
   <p align='center'><img  src='./files/7.png'/></p>
   <p align='center'><img  src='./files/8.png'/></p>
   <p align='center'><img  src='./files/9.png'/></p>
   <p align='center'><img  src='./files/10.png'/></p>
   <p>Para asegurarnos que nadie puede usar smbguest para entrar en nuestra máquina mediante login, modificamos el fichero "/etc/passwd" de la siguiente manera.</p>
   <p align='center'><img  src='./files/11.png'/></p>
   <p>A continuación creamos el grupo usuariosamba,
		y dentro de este ponemos a todos los panaderos, informaticos, supersamba y a smbguest</p>
		<p align='center'><img  src='./files/12.png'/></p>
	<p>Vamos a instalar el servidor samba en nuestro equipo</p>
	<p align='center'><img  src='./files/13.png'/></p>
	<p>Vamos a renombrar el fichero de configuración existente, y trabajaremos a partir de un fichero de configuración nuevo vacío: "mv /etc/samba/smb.conf /etc/samba/smb.conf.000".</p>
	<p align='center'><img  src='./files/14.png'/></p>
	<p>Creamos un fichero vacío "/etc/samba/smb.conf", y lo rellenamos con el contenido siguiente.</p>
	<p align='center'><img  src='./files/20.png'/></p>
	<p >Vamos a crear las carpetas de los recursos compartidos con los permisos siguientes</p>
	<p align='center'>/var/samba/public: Usuario propietario "supersamba", grupo propietario "usuariosamba". Poner permisos 770.</p>
	<p align='center'>/var/samba/panaderos: Usuario propietario "supersamba", grupo propietario "panaderos". Poner permisos 770.</p>
	<p align='center'>/var/samba/informaticos: Usuario propietario "supersamba", grupo propietario "informaticos". Poner permisos 770.</p>
	<p align='center'><img  src='./files/15.png'/></p>
	<p>Añadimos los usuarios creado a Samba.</p>
	<p align='center'><img  src='./files/17.png'/></p>
	<p>Comprobamos nuestra lista de usuarios Samba.</p>
	<p align='center'><img  src='./files/18.png'/></p>
	<p>Reiniciamos el servicio para que se lean los cambios.</p>
	<p align='center'><img  src='./files/19.png'/></p>
	<p>Verificamos la sintaxis del fichero de configuración del servidor Samba.</p>
	<p align='center'><img  src='./files/20.png'/></p>
	<p>Vemos que el servicio SMB/CIF está a la escucha.</p>
	<p align='center'><img  src='./files/21.png'/></p>
	  
	<h1><a id='bloque2'>Cliente Windows</a></h1>
	<p>Comprobamos los accesos de todas las formas posibles. Como si fuéramos un panadero, un informático y un invitado</p>
	<p align='center'><img  src='./files/22.png'/></p>
	<p align='center'><img  src='./files/23.png'/></p>
	<p align='center'><img  src='./files/24.png'/></p>
	<p align='center'><img  src='./files/25.png'/></p>
	<p>Para comprobar resultados, desde el servidor Samba ejecutamos.</p>
	<p align='center'><img  src='./files/27.png'/></p>
	<p align='center'><img  src='./files/28.png'/></p>
	<p align='center'><img  src='./files/29.png'/></p>
	
<h1><a id='final'>Cliente Linux</a></h1>
<p>En nuestro cliente instalamos "smb4k" para poder ver si podemos acceder a los recursos compartidos.</p>
<p align='center'><img  src='./files/30.png'/></p>
<p>Una vez instalamos el paquete lo abrimos e intentamos acceder a algún recurso compartido.</p>
<p align='center'><img  src='./files/31.png'/></p>
<p>Desde este equipo usaremos comandos para acceder a la carpeta compartida. Primero comprobar el uso de las siguientes herramientas.</p>
<p align='center'><img  src='./files/32.png'/></p>
<p align='center'><img  src='./files/33.png'/></p>
<p> Con el usuario root, usamos el siguiente comando para montar un recurso compartido de Samba Server, 
	como si fuera una carpeta más de nuestro sistema.</p>
<p align='center'><img  src='./files/35.png'/></p>
<p>Ejecutar el comando "df -hT". Vemos que todos se han montado correctamente.</p>
<p align='center'><img  src='./files/34.png'/></p>
<p>Volvemos a ejecutar "smbstatus" y "netstat -ntap".</p>
<p align='center'><img  src='./files/36.png'/></p>
<p align='center'><img  src='./files/37.png'/></p>
<p>Para desmontar el recurso remoto usamos el comando "umount".</p>
<p align='center'><img  src='./files/38.png'/></p>
<p>Para finalizar debemos realizar el montaje automatico, para ellos añadiremos las siguientes lineas en el fichero "/etc/fstab".</p>
<p align='center'><img  src='./files/39.png'/></p>
<p>Reiniciamos y comprobamos los resultados.</p>
<p align='center'><img  src='./files/40.png'/></p>

</body>
</html>
